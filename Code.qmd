--- 
title: "Stat 210 Project" 
author: "Sofia Silvosa" 
format: pdf 
---

# Introduction and Data



```{r read-data, message = F, warning = F}
library(tidyverse)
library(ggfortify)
library(viridis)
library(tidymodels)
library(ggplot2)
library(car)
library(leaps)
library(broom)
library(knitr)
library(dplyr)
library(MASS)
library(lme4)
library(glmnet)
library(readr)
library(readr)
movies <- read_csv("movies.csv")

```

There has been recent discussion on adequation representation in film.
The movie industry has changed a lot in the past couple of decades due to
increased advocady for diversity and inclusion. Over th years, we have
seen more BIPOC representation in entertainement as well as gender identity
and LGBTQ+ representation. Many in the film industry have also championed the increased representaion of women in film. For a while Hollywood procudced very little movies with female protagonists; let alone movies with apprpropirayte representation of women (Goodman, 2017). But there has been recent progress in the recent years with an impressive increase in female lead movies in the 2010s; not only that but these films have achived monetary sucesss. In 2016 with, 29 percent of protagonists in the top 100 box-office hits were women (Goodman, 2017)

However, merely having female prtagaonsits does not paint the ful picture if whether a movie actually does a good job in female representation. Many have used the so-called Bechdel test to make this judgement. The Bechdel test is


Does the decade a movie was released predict whether it passes the bechdel test (logistic regression)
will this change if we look at the variable in a multinomial fashion?

Does passing the bechdel test predict how much a movie is going to make while controllung for the budger???






```{r how-many-movies-passed-test-across-decades, message = F, warning = F}



# rename columns


colnames(movies)[which(names(movies) == "domgross_2013$")] <- "dom_Gross2013"
colnames(movies)[which(names(movies) == "budget_2013$")] <- "budget_Gross2013"
colnames(movies)[which(names(movies) == "intgross_2013$")] <- "int_Gross2013"

#remove NAs


movies1 <- movies[!(movies$dom_Gross2013=="#N/A" | movies$budget_Gross2013 =="#N/A"),]

movies1$ dom_Gross2013<- as.numeric(movies1$dom_Gross2013)
movies1$ budget_Gross2013 <- as.numeric(movies1$budget_Gross2013)
movies1$ int_Gross2013<- as.numeric(movies1$int_Gross2013)

#change units to a million

movies2 <- movies1 %>% 
  mutate(dom_gross_mil = dom_Gross2013 /1000000) %>% 
  mutate(int_gross_mil = int_Gross2013 /1000000) %>% 
    mutate(  budget_mil = budget_Gross2013 /1000000)


movies_decades <- movies2 %>% 
  mutate(decade= case_when(year < 1980 ~ '1970s' ,
                         1980<= year & 1990 > year ~ '1980s' ,
                         1990<= year & 2000 > year ~ '1990s' ,
                         2000<= year & 2010 > year ~ '2000s ',
                       2010 <= year ~ '2010s ' ))  
  
  ggplot(data= movies_decades, mapping= aes(x=decade, fill=binary)) +
  geom_bar()


movies_decades %>% 
  group_by(decade) %>% 
  summarise(number_of_movies =n())

movies_decades %>%
  group_by(decade) %>%
  summarize(passed_movies = sum(binary == 'PASS'))


proportion_70s = 14/ 54
proportion_80s = 36 / 125
proportion_90s = 147/ 337
proportion_2000s = 409/ 840
proportion_2010s = 197/ 438



```




```{r how-many-movies-passed-test-across-decades, message = F, warning = F}


  
  ggplot(data= movies_decades, mapping= aes(x=decade, fill=clean_test)) +
  geom_bar()





```

clean_ test: categories

men= women only about men
not talk= women do not talk to each other
ok= passed
no women= no women in the film
dubious = unclear


```{r how-many-movies-passed-test-across-decades, message = F, warning = F}


  
  ggplot(data= movies_decades, mapping= aes(x= binary, y= dom_gross_mil)) +
  geom_boxplot()





```


 ^^^ this looks bad but I do not think this difference is significant (lots of factors we are not controlling for)
 
 
 

```{r how-many-movies-passed-test-across-decades, message = F, warning = F}





ggplot(data = movies_decades, mapping = aes(x = year, y = dom_gross_mil )) +
  geom_point() +
  facet_grid(. ~ binary)



```


```{r how-many-movies-passed-test-across-decades, message = F, warning = F}





m1 <- lm(dom_gross_mil ~ binary + budget_mil + decade, data = movies_decades)
summary(m1) %>% 
  tidy() 



```


p= 0.000002595824

##Sources

https://www.nytimes.com/2017/02/21/movies/women-protagonists-movies-2016.html
https://www.tandfonline.com/doi/pdf/10.1080/14680777.2016.1234239?needAccess=true

https://fivethirtyeight.com/features/the-dollar-and-cents-case-against-hollywoods-exclusion-of-women/

